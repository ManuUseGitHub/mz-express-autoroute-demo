"use strict";exports.__esModule=!0,exports.MaskBuilder=void 0;var defaultCall=function(t,e,n){return 0},stripDots=function(t){return t.replace(/[.]/g,"")},substituteTwos=function(t){return t.replace(/2/g,"1")},MaskBuilder=function(){function t(){}return t.getInstance=function(){return t.instance=!t.instance?new t:t.instance},t.prototype.assignValuePerBit=function(t,e,n,r){if(e[2]){var o=e[2].length,s=e[0];t.masks[s]={};for(var a=0;a<o;++a){var i=Math.pow(2,n+a),i=this.formatedNumberRepresentation(i,r);"function"!=typeof e[2][a]&&void 0!==e[2][a]||(e[2][a]=(typeof e[2][a]).toUpperCase()),t.masks[s][i]=e[2][a]}}},t.prototype.dec2bin=function(t){return(t>>>0).toString(2)},t.prototype.pad=function(t,e){for(t=t.toString();t.length<e;)t="0"+t;return t},t.prototype.computeOffset=function(t){var e=0;return t.filter(function(t){return"boolean"==typeof t[1]&&2===t.length||t[2]}).map(function(t){e+=t[2]?t[2].length:1}),4*Math.ceil(e/4)},t.prototype.assignMasks=function(t,e,n){e=this.formatedNumberRepresentation(Math.pow(2,n),e);"-1"!==e&&(t.mask=e)},t.prototype.formatedNumberRepresentation=function(t,e){t=this.dec2bin(t),e=this.pad(t,e).match(/.{1,4}/g);return e?e.join("."):"-1"},t.prototype.defineInterval=function(t,e){return("boolean"!=typeof t[1]||2!==t.length)&&t[2]?[e,-1+e+t[2].length]:[e]},t.prototype.masksMappedByName=function(t,e,n){void 0===e&&(e=defaultCall),void 0===n&&(n="");for(var r={},o=0,s=Object.entries(t);o<s.length;o++){var a=s[o],i=a[0],p=a[1];if("string"==typeof p||n){a=e(r[p]=i,n,p);if(0!=a)return a}else"object"==typeof p&&(r[i]=this.masksMappedByName(p,e,i))}return r},t.prototype.applyMasks=function(t,r,o){var s=0;return this.masksMappedByName(t,function(t,e,n){if(o===n||o===e){t=stripDots(t);if(0!=(s=parseInt(r,2)&parseInt(t,2)))return s}return 0}),s},t.prototype.guessMaskFromMask=function(t){var e=[],n=0;for(t=stripDots(t);n<t.length;++n){var r=t.charAt(n);e.push("2"===r?1:"1"===r?0:"-")}return e.join("")},t.prototype.defineSortOption=function(t,e,n){var r=t.optionsOffset,r=this.formatedNumberRepresentation(e,r);return t.masks[n][r]},t.prototype.defineBooleansOption=function(t,e,n){switch(e){case"1":return!0;case"0":return!1;default:return t[n]}},t.prototype.chosenFromMask=function(t,e,n){var r=substituteTwos(stripDots(e)),o=this.guessMaskFromMask(e),s=this.applyMasks(t.masks,r,n);if(0<s){e=Math.log2(s),r=-1+o.length-e,e=t.optionsOffset,e=this.formatedNumberRepresentation(s,e),e=t.masks[e];return"string"!=typeof e?this.defineSortOption(t,s,n):this.defineBooleansOption(t.defaults,o[r],e)}n=/[\d.]/g.test(n)?t.masks[n]:n;return t.defaults[n]},t.prototype.getOptionsFromMask=function(e,n){var r=this,o={},t=this.masksMappedByName(e.masks);return Object.keys(t).map(function(t){o[t]=r.chosenFromMask(e,n,t)}),o},t}();exports.MaskBuilder=MaskBuilder;