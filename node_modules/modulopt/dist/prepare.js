"use strict";exports.__esModule=!0,exports.optionized=exports.beforeOptionize=exports.prepareOptionObject=exports.sortEntries=void 0;var apply_1=require("./apply"),dialog_1=require("./dialog"),MaskBuilder_1=require("./MaskBuilder"),Modulopt_1=require("./Modulopt"),mopt=Modulopt_1.Modulopt.getInstance(),mb=MaskBuilder_1.MaskBuilder.getInstance(),optionized=function(o,t,e){void 0===e&&(e=!1);var i={},n=t.optionVector,t=t.totalOffset;return mopt.buildDefinition(o.modulopt,t,{cpt:0,optionVector:n,definitions:i}),mopt.populateOptionsObjects(o.modulopt,i),o.options=Object.assign({},o.modulopt.defaults),(0,dialog_1.hintDefinitions)(o,e),o};exports.optionized=optionized;var fetchModuloptConfig=function(){return[["mismatch","ignore",["throw","yell","inform","warn","debug","report"]],["sort","no",["asc","dsc"]]]},fixModuloptConfig=function(o,t){var e=-1;t.forEach(function(o,t){"modulopt"===o[0]&&(e=t)}),-1!==e&&((0,apply_1.stickOptions)(o,t[e][1]),t.splice(e,1))},addModuloptConfig=function(o){var t=fetchModuloptConfig();o.modulopt.config={};t=beforeOptionize(o.modulopt.config,t,!0);optionized(o.modulopt.config,t)},beforeOptionize=function(o,t,e){void 0===e&&(e=!1),o.modulopt={},e||(addModuloptConfig(o),o.modulopt.logs=[],fixModuloptConfig(o.modulopt.config,t));e=sortEntries(o.modulopt.config,t),t=mb.computeOffset(e);return o.modulopt.optionsOffset=t,o.modulopt.masks={},o.modulopt.free={},o.modulopt.defaults={},{optionVector:e,totalOffset:t}};exports.beforeOptionize=beforeOptionize;var prepareOptionObject=function(o){o.options?o.options=Object.assign({},o.options):o.options=Object.assign({},o.modulopt.defaults)};exports.prepareOptionObject=prepareOptionObject;var sortEntries=function(o,t){function e(o,t){return o[0]>t[0]?1:o[0]<t[0]?-1:0}if(o&&"no"!==o.options.sort){if("asc"===o.options.sort)return t.sort(e);if("dsc"===o.options.sort)return t.sort(e).reverse()}return t};exports.sortEntries=sortEntries;